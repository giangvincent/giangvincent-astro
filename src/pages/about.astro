---
import PixelLayout from '../components/pixel/PixelLayout.astro';
import PixelSection from '../components/pixel/PixelSection.astro';
import PixelCard from '../components/pixel/PixelCard.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { fetchAboutContent, fetchHomepageContent } from '../lib/contentApi';

const aboutContent = await fetchAboutContent('default');
const homepageContent = await fetchHomepageContent();
const focusAreas = homepageContent.services.slice(0, 3);

const navItems = (
	[
		{ id: 'about', label: 'About' },
		focusAreas.length > 0 ? { id: 'focus', label: 'Focus' } : null,
		{ id: 'contact', label: 'Contact' },
	] as Array<{ id: string; label: string } | null>
).filter(Boolean) as Array<{ id: string; label: string }>;
---

<PixelLayout
	pageTitle={`About | ${SITE_TITLE}`}
	description={SITE_DESCRIPTION}
	navItems={navItems}
	sidebarIntro="Who I am, what I ship, and how to reach me."
>
	<PixelSection
		id="about"
		label="Story"
		title={aboutContent.title}
		description={aboutContent.summary}
	>
		<div class="pixel-intro-grid">
			<div class="pixel-intro-body" set:html={aboutContent.body}></div>
			<div>
				<p class="pixel-intro-body">
					I help founders and teams take ideas from sketchbook to production—fast. Product
					strategy, full-stack builds, and shipping discipline bundled into one partner.
				</p>
				<a class="pixel-cta" href="mailto:hello@giangvincent.com">Open a transmission</a>
			</div>
		</div>
	</PixelSection>

	{
		focusAreas.length > 0 && (
			<PixelSection
				id="focus"
				label="Focus"
				title="Now shipping"
				description="A snapshot of the services I’m running most often."
			>
				<div class="pixel-card-grid">
					{
						focusAreas.map((service) => (
							<PixelCard
								title={service.title}
								description={service.description}
								href={service.href}
								coverImageUrl={service.coverImageUrl}
								tags={service.tags}
							/>
						))
					}
				</div>
			</PixelSection>
		)
	}

	<PixelSection
		id="contact"
		label="Contact"
		title="Let’s collaborate"
		description="Have a roadmap, a stubborn bug, or a moonshot in mind? I’m all ears."
	>
		<p class="pixel-intro-body">
			Send a note to <a href="mailto:hello@giangvincent.com">hello@giangvincent.com</a> with a short
			brief, a timeline, and any handy context. I’ll reply within 48 hours with next steps and a plan
			to get things moving.
		</p>
	</PixelSection>
</PixelLayout>
