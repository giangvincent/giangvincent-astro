---
import PixelLayout from '../../components/pixel/PixelLayout.astro';
import PixelSection from '../../components/pixel/PixelSection.astro';
import PixelCard from '../../components/pixel/PixelCard.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';
import { fetchBlogPosts, sortPostsByPublishedDate } from '../../lib/blogApi';

const posts = sortPostsByPublishedDate(await fetchBlogPosts());
const navItems = [{ id: 'blogs', label: 'Blogs' }];
---

<PixelLayout
	pageTitle={`Blogs | ${SITE_TITLE}`}
	description={SITE_DESCRIPTION}
	navItems={navItems}
	sidebarIntro="Dive into the latest changelogs, learnings, and launch notes."
>
	<PixelSection
		id="blogs"
		label="Logs"
		title="Blog feed"
		description="Signals from the build room. Fresh drops land here first."
	>
		<div class="pixel-card-grid">
			{
				posts.length > 0 ? (
					posts.map((post) => (
						<PixelCard
							title={post.title}
							description={post.excerpt}
							href={`/blog/${post.slug}/`}
							coverImageUrl={post.coverImageUrl}
						/>
					))
				) : (
					<div class="pixel-empty-state">Nothing in the feed yet. Check back after the next drop.</div>
				)
			}
		</div>
	</PixelSection>
</PixelLayout>
